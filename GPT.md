Ниже я приведу пример набора математических моделей, который можно использовать для анализа работы перекрёстка с циклическим режимом (зеленая/красная фаза) с учетом наблюдаемого потока на каждой полосе. При этом я постараюсь логически обосновать каждую формулу, а затем прокомментировать полученные значения в выводе.

---

## 1. Интенсивность потока на полосе

Для каждой полосы $ i $ мы знаем общее число машин $ N_i $, зафиксированных за период наблюдения длительностью $ T $ секунд. Тогда средняя интенсивность потока определяется как:
$$
\lambda_i = \frac{N_i}{T} \quad \text{(машин/сек)}
$$
**Обоснование:**  
При равномерном поступлении за $ T $ секунд деление суммарного числа машин на $ T $ дает среднее число прибытия автомобилей в секунду.

---

## 2. Пропускная способность перекрёстка

Перекрёсток имеет $ n $ полос. Если для каждой полосы при зеленой фазе характерна насыщенная пропускная способность $ s $ (машин/сек, значение можно взять из нормативов или измерить эмпирически), то за один цикл светофора (длительностью $ C = T_g + T_r $) доля зеленой фазы составляет $ \frac{T_g}{C} $. Тогда на одной полосе максимально возможно проехать за один цикл:
$$
\text{Машин/цикл}_\text{полоса} = s \times T_g.
$$
Если умножить на число полос, получаем относительную пропускную способность перекрёстка (в машинах/сек):
$$
\mu = n \cdot s \cdot \frac{T_g}{C}.
$$
**Обоснование:**  
Каждая полоса может обслужить $ s $ машин в секунду, но машины пускаются только во время зеленой фазы, поэтому умножаем на $ T_g/C $. Если считать, что $ n = \text{число полос} $, то получаем суммарную способность перекрёстка.

---

## 3. Характеристики очереди на красном сигнале

При красном сигнале машины не могут двигаться, и они накапливаются в очереди. Для каждой полосы $ i $ можно рассмотреть следующие показатели:

### а) Число машин в очереди

Если интенсивность потока на полосе равна $ \lambda_i $ (машин/сек), то за время красной фазы $ T_r $ накопится:
$$
N_{\text{queue},i} = \lambda_i \cdot T_r.
$$
**Обоснование:**  
За каждую секунду в очередь добавляется в среднем $ \lambda_i $ машин, поэтому за $ T_r $ секунд их будет $ \lambda_i T_r $.

### б) Длина очереди в метрах

При условии, что каждая машина (с учетом межмашинного интервала) занимает длину $ L $ (м), суммарная длина очереди будет:
$$
L_{q,m,i} = N_{\text{queue},i} \cdot L = \lambda_i \cdot T_r \cdot L.
$$
**Обоснование:**  
Просто умножаем число машин на длину, которую занимает каждая.

### в) «Длина очереди» в секундах (время освобождения очереди)

Чтобы перевести число машин в очередь в время, необходимое для их освобождения, используется насыщенная пропускная способность $ s $ (машин/сек). Тогда время, за которое очередь опустеет, можно оценить как:
$$
L_{q,s,i} = \frac{N_{\text{queue},i}}{s} = \frac{\lambda_i \cdot T_r}{s}.
$$
**Обоснование:**  
Если при зеленой фазе из очереди выходит $ s $ машин в секунду, то для $ N_{\text{queue},i} $ машин потребуется $ N_{\text{queue},i} / s $ секунд.

### г) Задержка в очереди (среднее время ожидания)

При неравномерном потоке (и даже при случайных флуктуациях) средняя задержка автомобиля зависит от того, как распределено время прибытия по очереди. Для простоты можно предложить модель, в которой задержка растёт с увеличением загруженности. Например, при условии, что при малых нагрузках средняя задержка приближается к $ T_r/2 $, а при приближении потока к насыщению задержка экспоненциально возрастает, можно записать:
$$
d_i = \frac{T_r}{2} \cdot \frac{1}{1 - X_i} \quad \text{где } X_i = \frac{\lambda_i}{s}.
$$
**Обоснование:**  
- Если $ \lambda_i \ll s $ (т.е. $ X_i \to 0 $), то $ d_i \approx \frac{T_r}{2} $ – средняя задержка для равномерного поступления.
- При $ \lambda_i $ приближается к $ s $ (т.е. $ X_i \to 1 $) знаменатель стремится к нулю, и задержка растёт, что отражает экспоненциальный рост задержки при перегрузке.
  
Эта модель имеет смысл, если поток не является детерминированным, и позволяет учитывать нелинейное увеличение задержки с ростом степени насыщения.

Альтернативно, можно попытаться вывести задержку через интегральные соотношения (например, используя модель накопления очереди в системе с периодическим обслуживанием), но приведённая формула отражает базовую идею: чем выше загрузка (ближе $ \lambda_i $ к $ s $), тем больше ожидаемая задержка.

---

## 4. Сравнение с имеющимися формулами в коде

В представленном коде используются следующие модели:

- **Интенсивность потока:**  
  $ \lambda_i = \frac{N_i}{T} $.  
  Это соответствует нашей модели.

- **Пропускная способность перекрёстка:**  
  Код вычисляет её как:
  $$
  \mu = n \cdot s \cdot \frac{T_g}{T_g + T_r},
  $$
  где $ n = \text{число полос} $.  
  Это логично, поскольку за полный цикл обслуживается $ s \times T_g $ машин на каждую полосу.

- **Длина очереди (в метрах):**  
  $ L_{q,m,i} = \lambda_i \cdot T_r \cdot L $.  
  Это прямолинейное умножение числа машин в очереди на длину автомобиля.

- **Длина очереди (в секундах):**  
  $ L_{q,s,i} = \frac{\lambda_i \cdot T_r}{s} $.  
  Это время, необходимое для обслуживания накопленной очереди при максимальном потоке $ s $.

- **Задержка в очереди:**  
  В коде используется формула:
  $$
  d_i = \frac{\lambda_i \cdot T_r^2}{2 \cdot s},
  $$
  но по анализу размерностей эта формула дает размерность $ \text{сек}^2 $.  
  Мы предлагаем вместо неё использовать модель:
  $$
  d_i = \frac{T_r}{2} \cdot \frac{1}{1 - (\lambda_i/s)},
  $$
  при условии, что $ \lambda_i < s $.  
  **Обоснование:**  
  При малой нагрузке задержка близка к $ T_r/2 $ (среднее время ожидания в красную фазу для равномерного потока), а при приближении к насыщению задержка растёт существенно. Эта модель имеет корректные размерности (секунды) и отражает нелинейное увеличение задержки.

---

## 5. Комментарий по полученным результатам

Обратим внимание на вывод для каждой полосы. Например, для полосы 1:
- $ \lambda_1 \approx 10.92 $ машин/сек – это очень высокий поток для одной полосы, что приводит к огромному числу накопленных машин за красную фазу, большим длинам очереди (более 1400 м) и соответственно очень большим значениям времени освобождения очереди (около 655 сек).  
- Значение задержки $ d \approx 9830 $ сек (примерно 2.7 часа) выглядит нереалистично и, скорее всего, является следствием применения формулы, чувствительной к высокому значению $ \lambda_i/s $. Если $ \lambda_i $ приближается к $ s $ или превышает его, используемая модель становится неадекватной – в реальной ситуации такой поток недопустим, и перекрёсток либо перегружен, либо параметры $ s $ подбираются неверно.

Для полос с более низкой интенсивностью (например, полоса 5, $ \lambda \approx 0.37 $ машин/сек) получаются более «разумные» значения задержки (около 333 сек, что всё же достаточно высоко, но может быть объяснено длительным красным сигналом).

**Важное замечание по выбору параметра $ s $:**  
В данном коде используется значение $ s = 0.5 $ машин/сек, что соответствует примерно 1 машине за 2 секунды. Это значение нужно выбирать исходя из нормативных данных или экспериментальных измерений для конкретного перекрёстка. Если выбранное значение слишком низкое по сравнению с реальным потоком, модель покажет перегрузку системы с экстремальными задержками.

---

## Итоговый набор моделей

Мы предлагаем следующие логически обоснованные формулы для полосы $ i $:

1. **Интенсивность потока:**
   $$
   \lambda_i = \frac{N_i}{T} \quad (\text{машин/сек})
   $$
2. **Число машин в очереди:**
   $$
   N_{\text{queue},i} = \lambda_i \cdot T_r
   $$
3. **Длина очереди в метрах:**
   $$
   L_{q,m,i} = \lambda_i \cdot T_r \cdot L
   $$
4. **Время освобождения очереди (в секундах):**
   $$
   L_{q,s,i} = \frac{\lambda_i \cdot T_r}{s}
   $$
5. **Средняя задержка автомобиля в очереди:**

   При условии, что $ X_i = \lambda_i/s < 1 $, можно использовать:
   $$
   d_i = \frac{T_r}{2} \cdot \frac{1}{1 - X_i}
   $$
   Эта формула дает $ d_i $ в секундах и отражает рост задержки по мере приближения потока к насыщенной способности.

6. **Пропускная способность перекрёстка (в машинах/сек):**
   $$
   \mu = n \cdot s \cdot \frac{T_g}{T_g + T_r}
   $$

---

## Заключение

- Модель интенсивности ($ \lambda_i $) и число машин в очереди ($ \lambda_i T_r $) основаны на стандартном статистическом подходе.
- Преобразование числа машин в очередь в метрическую длину или в время (через $ s $) позволяет оценить, насколько быстро система способна «очистить» очередь.
- Для задержки мы предлагаем использовать формулу $ d_i = \frac{T_r}{2} \cdot \frac{1}{1 - (\lambda_i/s)} $, которая корректна по размерностям (секунды) и отражает нелинейное увеличение задержки при приближении к предельной пропускной способности.
- Выбор параметра $ s $ критически важен – его нужно брать из эмпирических данных или нормативов для конкретных дорожных условий.

Таким образом, предложенный набор моделей позволяет логически обосновать взаимосвязи между входными данными (число машин, длительности фаз, длина автомобиля) и ключевыми характеристиками перекрёстка (пропускная способность, длина и время освобождения очереди, задержка). При этом полученные результаты дают понимание того, насколько система загружена и какие показатели (например, задержка) могут оказаться критичными при высоких потоках.